flowchart TD
  %% 前端层
  subgraph s1["前端层"]
    A["用户界面"]
    B["前端框架<br/>(Next.js 14 App Router)"]
    C["功能层逻辑模块"]
    F[/"路由结构<br/>src/app/"/]
    G["状态管理<br/>Zustand + React Context"]
    D{"教学组件库"}
    D1{"多媒体元素组件"}
    D2{"api接口工具"}
    D3{"AI交互组件"}
  end

  %% 服务层
  subgraph s2["服务层"]
    J["后端服务<br/>Node.js"]
    K["API 路由<br/>Next.js Edge Runtime"]
    L["实时通信支持<br/>WebSocket"]
    M["AI 网关引擎<br/>Dify"]
    N1["多媒体生成模块"]
    N2["习题推荐系统"]
    N3["智能问答系统"]
    N4["资源搜索系统"]
  end

  %% 数据层
  subgraph s3["数据层"]
    N[("关系型数据库<br/>PostgreSQL")]
    O["ORM 映射<br/>Prisma 客户端"]
    P[("缓存数据库<br/>Redis")]
    Q["实时状态管理<br/>Session 缓存"]
    R[("对象存储系统<br/>MinIO")]
    S["教学资源存储<br/>课件 / 试卷"]
  end

  %% 基础设施层
  subgraph s4["基础设施层"]
    T["进程管理器<br/>PM2"]
    U["服务集群管理<br/>Node.js 集群"]
    V["Web 服务器<br/>Nginx"]
    W["反向代理<br/>负载均衡"]
    X["容器平台<br/>Docker"]
    Y["生产环境<br/>Kubernetes"]
  end

  %% 连接关系
  A --> B --> C --> D
  B -- 动态路由 --> F
  B -- 状态管理 --> G
  C --> D1
  C --> D2
  C --> D3
  J -- API 接口 --> K
  J -- 实时通信 --> L
  J -- AI 服务接入 --> M
  M --> N1
  M --> N2
  M --> N3
  M --> N4
  N --> O
  P --> Q
  R --> S
  T --> U
  V --> W
  X --> Y

  %% 样式美化
  style A fill:#e1f5fe,stroke:#039be5
  style J fill:#fbe9e7,stroke:#ff7043
  style N fill:#e8f5e9,stroke:#43a047
  style T fill:#f3e5f5,stroke:#ab47bc
